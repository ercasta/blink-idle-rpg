{
  "version": "1.0",
  "module": "unnamed",
  "metadata": {
    "compiled_at": "2026-01-19T07:42:46Z",
    "compiler_version": "0.1.0"
  },
  "components": [
    {
      "id": 0,
      "name": "Character",
      "fields": [
        {
          "name": "name",
          "type": {
            "type": "string"
          }
        },
        {
          "name": "level",
          "type": {
            "type": "number"
          }
        }
      ]
    },
    {
      "id": 1,
      "name": "Health",
      "fields": [
        {
          "name": "current",
          "type": {
            "type": "number"
          }
        },
        {
          "name": "max",
          "type": {
            "type": "number"
          }
        }
      ]
    },
    {
      "id": 2,
      "name": "Attack",
      "fields": [
        {
          "name": "damage",
          "type": {
            "type": "number"
          }
        },
        {
          "name": "speed",
          "type": {
            "type": "number"
          }
        }
      ]
    },
    {
      "id": 3,
      "name": "Target",
      "fields": [
        {
          "name": "entity",
          "type": {
            "type": "entity"
          }
        }
      ]
    }
  ],
  "rules": [
    {
      "id": 0,
      "name": "attack_rule",
      "trigger": {
        "type": "event",
        "event": "DoAttack"
      },
      "actions": [
        {
          "type": "conditional",
          "condition": {
            "type": "binary",
            "op": "neq",
            "left": {
              "type": "field",
              "entity": "entity",
              "component": "Target",
              "field": "entity"
            },
            "right": {
              "type": "literal",
              "value": null
            }
          },
          "then_actions": [
            {
              "type": "modify",
              "entity": {
                "type": "var",
                "name": "target"
              },
              "component": "Health",
              "field": "current",
              "op": "subtract",
              "value": {
                "type": "var",
                "name": "damage"
              }
            },
            {
              "type": "schedule",
              "event": "DoAttack",
              "delay": {
                "type": "var",
                "name": "delay"
              },
              "fields": {
                "source": {
                  "type": "var",
                  "name": "id"
                }
              }
            }
          ]
        }
      ]
    },
    {
      "id": 1,
      "name": "death_check",
      "trigger": {
        "type": "event",
        "event": "DoAttack"
      },
      "actions": [
        {
          "type": "conditional",
          "condition": {
            "type": "binary",
            "op": "lte",
            "left": {
              "type": "field",
              "entity": "entity",
              "component": "Health",
              "field": "current"
            },
            "right": {
              "type": "literal",
              "value": 0.0
            }
          },
          "then_actions": [
            {
              "type": "schedule",
              "event": "Death",
              "fields": {
                "target": {
                  "type": "var",
                  "name": "id"
                }
              }
            }
          ]
        }
      ]
    }
  ],
  "functions": [
    {
      "id": 0,
      "name": "calculate_damage",
      "params": [
        {
          "name": "base",
          "type": {
            "type": "number"
          }
        },
        {
          "name": "multiplier",
          "type": {
            "type": "number"
          }
        }
      ],
      "return_type": {
        "type": "number"
      },
      "body": {
        "type": "binary",
        "op": "multiply",
        "left": {
          "type": "var",
          "name": "base"
        },
        "right": {
          "type": "var",
          "name": "multiplier"
        }
      }
    }
  ]
}